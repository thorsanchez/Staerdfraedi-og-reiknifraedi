# -*- coding: utf-8 -*-
"""T11.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wQtIEIKQCdP85J-EkGO6trb92zv9RB0R

Sko√∞i√∞ fyrst (og keyri√∞) d√¶mi√∞ √≠ bl√°a rammanum aftast √≠ kafla 1.3 √≠ n√Ωja n√°msefninu.
***
"""

import numpy as np
import matplotlib.pyplot as plt
def f(x,y):
  f1 = 3/(1+(x-2)**2+4*(y-3)**2)
  f2 = 4/(1+x**2+y**2)
  return f1 - f2

x = np.linspace(-2,4)
y = np.linspace(-1,4)
(X,Y) = np.meshgrid(x,y)
Z = f(X,Y)
plt.set_cmap('rainbow')
plt.contour(X, Y, Z, linewidths=3)
plt.colorbar()
plt.grid('True')

"""VV7. L√°gm√∂rkun Rosenbrock-fallsins
***

Afriti√∞ forriti√∞ a√∞ ofan inn √≠ Colab. Minnki√∞ sv√¶√∞i√∞ sem falli√∞ er teikna√∞ √° um h√°lfa einingu √° √∂llum hli√∞um, ni√∞ur √≠ ferninginn [‚àí1.5,1.5]√ó[‚àí0.5,2.5]. Pr√≥fi√∞ a√∞ fj√∂lga h√¶√∞arl√≠nunum. Reikni√∞ l√≠ka fallsgildi√∞ √≠ ùë•0=(‚àí1.2,1) sem √¶tti a√∞ vera 24.2 og ùë•‚àó=(1,1) sem √¶tti a√∞ vera 0.
***
"""

def rosen(x):
    res = (1-x[0])**2 + 100*(x[1] - x[0]**2)**2
    return res

import matplotlib.pyplot as plt
import numpy as np
plt.figure(figsize=(8,8))
x = np.linspace(-1.5, 1.5, 800)
y = np.linspace(-0.5, 2.5, 1200)
[X,Y] = np.meshgrid(x,y)
Z = rosen([X,Y])
levels = np.linspace(0, 2000, 41)
c = plt.contour(X, Y, Z, levels = levels, colors = 'gray')
levstr = {l:str(l) for l in levels}
plt.clabel(c, fmt=levstr)
plt.xticks(range(-1, 2))
plt.yticks(range(0, 3))
plt.grid(True)

x0_val = rosen([-1.2, 1])
print("x0=(-1.2, 1):", x0_val)

xstar_val = rosen([1, 1])
print("x*=(1, 1):", xstar_val)

"""√æar sem f er falli√∞ sem √° a√∞ l√°gmarka, x0 er vigur me√∞ byrjunar√°giskun og xmin er l√°ggildispunkturinn. Noti√∞ minimize til a√∞ l√°gmarka fall Rosenbrocks me√∞ ùë•0=(‚àí1.2,1). Sko√∞i√∞ hva√∞ er √≠ result og skrifi√∞ √∂rf√° or√∞ um √æa√∞.
***
"""

import scipy.optimize as opt

def rosen(x):
    return (1-x[0])**2 + 100*(x[1] - x[0]**2)**2

x0 = (-1.2, 1)
result = opt.minimize(rosen, x0)

print(result)

"""minimize getur teki√∞ inn vi√∞b√≥tarstika callback=cb, og √æ√° kallar √æa√∞ √° cb(xk) me√∞ n√∫verandi √≠trekunargildi xk √≠ hverri √≠trekun (√≠ √æessu tilviki er xk tveggja staka vigur). Noti√∞ √æennan ‚Äûf√≠dus‚Äú til a√∞ teikna √≠trekunargildin inn √° h√¶√∞arl√≠numyndina (h√¶gt er a√∞ l√°ta cb kalla √° plt.scatter(x[0],x[1]))
***
"""

def rosen(x):
    res = (1-x[0])**2 + 100*(x[1] - x[0]**2)**2
    return res

import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import minimize

plt.figure(figsize=(8,8))
x = np.linspace(-2,2,400)
y = np.linspace(-1,3,400)
[X,Y] = np.meshgrid(x,y)
Z = rosen([X,Y])
levels = [0.2, 5, 50] + list(range(200,2300,400))
c = plt.contour(X, Y, Z, levels = levels, colors = 'gray')
levstr = {l:str(l) for l in levels}
plt.clabel(c, fmt=levstr)
plt.xticks(range(-2,3))
plt.yticks(range(-1,4))
plt.grid("True")

def cb(xk):
    plt.scatter(xk[0], xk[1], color='r')

res = minimize(rosen, [0, 0], callback=cb)
plt.scatter(res.x[0], res.x[1], color='g')

"""minimize getur l√≠ka teki√∞ inn stika method="a√∞fer√∞", √æar sem a√∞fer√∞ getur t.d. veri√∞ "L-BFGS-B", "CG", og "Powell" fyrir utan √æ√° sj√°lfv√∂ldu, "BFGS". Pr√≥fi√∞ og segi√∞ skipulega fr√° ni√∞urst√∂√∞um. Pr√≥fi√∞ l√≠ka eina sj√°lfvalda a√∞fer√∞ (sko√∞i√∞ skj√∂lun um minimize √° netinu til a√∞ sj√° m√∂guleikana).
***
"""

import numpy as np
from scipy.optimize import minimize, rosen

x0 = np.array([0, 0])

methods = ['BFGS', 'L-BFGS-B', 'CG', 'Powell']

standalone_method = {'method': 'COBYLA'}

for method in methods + [standalone_method]:
    print(f"\n{method} Optimization")
    print("=" * 30)
    res = minimize(rosen, x0, method=method)
    print(f"Success: {res.success}")
    print(f"Function value: {res.fun}")
    print(f"Number of iterations: {res.nit}")
    print(f"Number of function evaluations: {res.nfev}")
    print(f"Solution: {res.x}")

"""√Åkvar√∞i√∞ hlutaflei√∞ur og √æar me√∞ stigul Rosenbrock-fallsins (√° bla√∞i) og forriti√∞ hann √≠ Python falli rosg(x) sem skilar tveggja staka NumPy-vigri me√∞ stiglinum √≠ punktinum ùë•=(ùë•0,ùë•1). Ef r√©tt er forrita√∞ √¶tti stigullinn √≠ ùë•0 a√∞ vera (‚àí215.6,‚àí88) og √≠ ùë•=(1,1) √¶tti hann a√∞ vera (0,0).
***
"""

import numpy as np

def rosg(x):
    x0, x1 = x[0], x[1]
    dfdx0 = -2*(1 - x0) - 400*(x1 - x0**2)*x0
    dfdx1 = 200*(x1 - x0**2)
    return np.array([dfdx0, dfdx1])
rosg(np.array([1, 1]))

"""skil ekki alveg hva√∞ √° a√∞ gera √≠ li√∞ 6"""

